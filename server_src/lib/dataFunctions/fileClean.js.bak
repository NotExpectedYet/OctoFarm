// Line 270 (after return of getCost)
    // console.log(filamentSelection, lengths, time)

    // let printPercentage = 0;
    // //Fix for old records
    // if(typeof metrics !== 'undefined' && typeof metrics.filament !== 'undefined' && metrics.filament !== null){
    //     if(!success){
    //         printPercentage = (metrics.estimatedPrintTime / time) * 100;
    //     }
    //     metrics = metrics.filament
    // }else{
    //     metrics = null
    // }        //Get spoolname function
    // function spoolName(id){
    //     if(typeof id !== 'undefined' && id !== null ){
    //         if(serverSettings[0].filamentManager){
    //             return `${id.spools.name} (${(id.spools.weight - id.spools.used).toFixed(0)}g) - ${id.spools.profile.material}`;
    //         }else{
    //             return `${id.spools.name} - ${id.spools.profile.material}`;
    //         }
    //     }else{
    //         return null;
    //     }
    // }
    // //Get spoolid function
    // function spoolID(id){
    //     if(typeof id !== 'undefined' && id !== null ){
    //         return id._id
    //     }else{
    //         return null;
    //     }
    // }
    // function getWeight(length, spool){
    //     if(typeof spool !== 'undefined' && spool !== null ){
    //         if(typeof length !== 'undefined'){
    //             if (length === 0) {
    //                 return length;
    //             } else {
    //                 let radius = parseFloat(spool.spools.profile.diameter) / 2
    //                 let volume = (length * Math.PI * radius * radius)
    //                 let usage = "";
    //                 if(success){
    //                     usage = volume * parseFloat(spool.spools.profile.density)
    //                 }else {
    //                     usage = volume * parseFloat(spool.spools.profile.density) / printPercentage;
    //                 }
    //                 return usage;
    //
    //             }
    //         }else{
    //             return 0;
    //         }
    //     }else{
    //         if(typeof length !== 'undefined'){
    //             length = length;
    //             if (length === 0) {
    //                 return length;
    //             } else {
    //                 let radius = 1.75 / 2
    //                 let volume = (length * Math.PI * radius * radius)
    //                 let usage = "";
    //                 if(success){
    //                     usage = volume * 1.24
    //                 }else {
    //                     usage = volume * 1.24 / printPercentage;
    //                 }
    //                 return usage;
    //             }
    //         }else{
    //             return 0;
    //         }
    //     }
    //
    // }
    // function getType(spool){
    //     if(typeof spool !== 'undefined' && spool !== null){
    //         return spool.spools.profile.material;
    //     }else{
    //         return "";
    //     }
    // }
    // function getCost(grams, spool){
    //     if(typeof spool !== 'undefined' && spool !== null ){
    //         if(success){
    //             return ((spool.spools.price / spool.spools.weight) * grams).toFixed(2)
    //         }else{
    //             return (((spool.spools.price / spool.spools.weight) * grams) / printPercentage).toFixed(2);
    //         }
    //
    //     }else{
    //         return null;
    //     }
    // }
    //
    // let spools = [];
    // if(typeof metrics !== 'undefined' && metrics !== null){
    //     let keys = Object.keys(metrics)
    //     for(let m = 0; m < keys.length; m++){
    //         let spool = {};
    //         if(success){
    //             spool = {
    //                 [keys[m]]: {
    //                     toolName: "Tool " + keys[m].substring(4, 5),
    //                     spoolName: null,
    //                     spoolId: null,
    //                     volume: metrics[keys[m]].volume,
    //                     length: metrics[keys[m]].length / 1000,
    //                     weight: null,
    //                     cost: null
    //                 }
    //             }
    //         }else{
    //             spool = {
    //                 [keys[m]]: {
    //                     toolName: "Tool " + keys[m].substring(4, 5),
    //                     spoolName: null,
    //                     spoolId: null,
    //                     volume: metrics[keys[m]].volume / printPercentage,
    //                     length: (metrics[keys[m]].length / 1000) / printPercentage,
    //                     weight: null,
    //                     cost: null
    //                 }
    //             }
    //         }
    //
    //         if(Array.isArray(filamentSelection)){
    //             spool[keys[m]].spoolName = spoolName(filamentSelection[m]);
    //             spool[keys[m]].spoolId = spoolID(filamentSelection[m]);
    //             spool[keys[m]].weight = getWeight(metrics[keys[m]].length / 1000, filamentSelection[m])
    //             spool[keys[m]].cost = getCost(spool[keys[m]].weight, filamentSelection[m])
    //             spool[keys[m]].type = getType(filamentSelection[m])
    //         }else{
    //             spool[keys[m]].spoolName = spoolName(filamentSelection);
    //             spool[keys[m]].spoolId = spoolID(filamentSelection);
    //             spool[keys[m]].weight = getWeight(metrics[keys[m]].length / 1000, filamentSelection)
    //             spool[keys[m]].cost = getCost(spool[keys[m]].weight, filamentSelection)
    //             spool[keys[m]].type = getType(filamentSelection)
    //         }
    //         spools.push(spool)
    //     }
    //     return spools;
    // }else{
    //     return null
    // }